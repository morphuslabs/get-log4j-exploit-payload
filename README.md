# get-log4j-exploit-payload

The **GetLog4jExploitPayload** (beta) is a tool whose purpose is to download java classes (payloads) referenced by Log4Shell JDNI addresses. It may be useful for research and incident response analysis. 

**Log4Shell** is the name given to a vulnerability affecting Log4Shell (CVE-2021-44228). The vulnerability is associated with the Log4j JNDI lookup feature, which on versions <= 2.14.1, by default creates objects of the class returned by the lookup operation. There are many good references for the vulnerability including [Log4Shell Followup](https://isc.sans.edu/forums/diary/Log4j+Log4Shell+Followup+What+we+see+and+how+to+defend+and+how+to+access+our+data/28122/) and [RCE in log4j](https://isc.sans.edu/forums/diary/RCE+in+log4j+Log4Shell+or+how+things+can+get+bad+quickly/28120/) from SANS, [Lunasec](https://www.lunasec.io/docs/blog/log4j-zero-day/), [Reddit](https://www.reddit.com/r/blueteamsec/comments/rd38z9/log4j_0day_being_exploited/?utm_source=share&utm_medium=ios_app&utm_name=iossmf) and [MorphusLabs](https://morphuslabs.com/log4shell-vulnerabilidade-cr%C3%ADtica-afeta-biblioteca-log4j-urgente-378dd9af4b88) (in Portuguese).

### Usage

```
git clone https://github.com/morphuslabs/get-log4j-exploit-payload
cd get-log4j-exploit-payload
javac GetLog4jExploitPayload.java
mkdir <output-dir>
java GetLog4jExploitPayload <ldap address> <output-dir>
```

Do not include the "jndi:" on the address parameter. Pass just the ldap or rmi address. 

### Example

```
mkdir payloads
java GetLog4jExploitPayload ldap://127.0.0.1:1389/a payloads
Referenced class: http://127.0.0.1:8888/MyExploit.class
Retrieving payload...done.

ls payloads/
MyExploit.class.dump
```

As the next step, you could use a Java decompiler as [FernFlower](https://github.com/fesh0r/fernflower) to analyze the payload.

**Use at your own risk.**

Good look!

